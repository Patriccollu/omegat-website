<div class="container">

<h2>OmegaT 技術情報：<br/>OmegaT のテキスト出力機能（外部スクリプト向け）の使用</h2>

<p>OmegaT のバージョン 2.0.1 以降にはテキスト出力機能があります。この技術情報は、同機能とその利用方法について説明します。さらに、パッケージ <a href="/files/omegatk/te-scripts.zip">te-scripts.zip</a> には、この機能を説明するためのごく簡単な tcl/tk スクリプトが含まれています。</p>

<h3>目的</h3>

<p>テキスト出力機能は、現在作業中の OmegaT プロジェクトのデータを、プレーンテキストファイルとして出力します。現在時点では、以下のデータを出力できます。</p>

<p>- 編集中の分節の原文テキスト<br/>- 編集中の分節の訳文テキスト<br/>- しかるべきショートカットキーを押したときの、訳文中の選択されたテキスト</p>

<p>OmegaT へ機能を追加するためにプログラムやスクリプトを書くときに、このようなテキストを含むファイルを利用することができます。Java の知識がなくても、ほとんどのプログラミング言語を使用でき、プログラミング技術が限られていても、有用な機能を実現できます。</p>

<h3>テキスト出力機能の使用</h3>

<p>テキスト出力機能を使用するには、まず OmegaT 内で有効にする必要があります。</p>

<p>［設定］→［翻訳入力行］</p>

<p>次に、「分節をテキストファイルへ出力」ボックスをチェックします。</p>

<p>ファイルは、OmegaT の個人設定フォルダー配下の script フォルダーに作成されます。<br/>（使用 OS の OmegaT 個人設定フォルダーの場所については、取扱説明書（OmegaT で F1）→［ファイルとフォルダー］→［個人設定ファイル］を参照してください。）</p>

<p>source.txt：編集中の分節の原文テキストが入っています。<br/>target.txt：編集中の分節の訳文テキストが入っています。<br/>selection.txt：Ctrl+Shift+Cを押すか、または［編集］→［選択領域を出力］を選択したときに、ユーザーが選択していたテキストが入っています。</p>

<p>ファイルの内容は、新しい分節へ移動したとき（source.txt と target.txt）、または新しい選択領域を出力したとき（selection.txt）に上書きされます。ファイル形式は、書式のないプレーンテキストファイルです。</p>

<h3>サンプルスクリプトの使用</h3>

<p>インストールされていなければ、Tcl/Tk をインストールする必要があります。Tcl/tk は、さまざまな入手先があります。よく知られているのは、tcl.activestate.com です。Mac OSX ユーザーは、OS 媒体から tcl/tk をインストールできます。Linux ユーザーは、初期設定でインストールされていなければ、ディストリビューションのリポジトリからインストールできます。（Ubuntu ユーザーへの注意：現バージョン（9.10）の Ubuntu で初期インストールされる tcl/tk の字体は、実装に不具合がありますが、是正可能です。）</p>

<p>スクリプトコードの機能を明確にするために、各スクリプトは実質的に 1 つの機能のみを果たします。複数の機能を同時に使用したい場合は、単一のスクリプトファイルに統合するのが効率的でしょう。</p>

<p><a href="/files/omegatk/te-scripts.zip">ここに</a>示すサンプルスクリプトは、いずれもウィンドウを起動しますが、背後で機能を果たすスクリプトも十分に考えられます。</p>

<p>スクリプトの起動方法</p>

<p>OmegaT の「スクリプト」フォルダー（「source.txt」などが入っている）内にスクリプトをコピーします。（スクリプトは原則として任意の場所に置くことができますが、その場合、スクリプトファイルのパスを追加して編集する必要があります。）</p>

<p>システム構成によっては、単にマウスでクリックすることによってスクリプトを起動できます。別の方法としては、</p>

<p>コマンドラインウィンドウ（DOS プロンプト、ターミナル、コンソール）を開きます。</p>

<p>スクリプトフォルダーの場所（ディレクトリ）を変更します（Windows XP システムの例）：</p>

<p>cd C:\Documents and Settings\User Name\Application Data\OmegaT\script</p>

<p>「wish」のあとにスクリプトファイル名を入力して、スクリプトを起動します。例：</p>

<p>wish te-basic-source.tcl</p>

<h3>各スクリプトの説明</h3>

<p><strong>te-basic-source</strong></p>

<p>このスクリプトは、原文テキストを別のウィンドウで表示します。OmegaT 編集ウィンドウでなされたことは、何も反映しません。スクリプトファイルからテキストを抽出でき、それをさらにスクリプトで処理できることを示すのが目的です。スクリプトウィンドウの内容は編集可能であり、コピーして OmegaT 編集ウィンドウに貼り付けることができます。</p>

<p><strong>te-basic-target</strong></p>

<p>te-basic-source と同様の機能ですが、訳文テキストを処理します。</p>

<p><strong>te-warning</strong></p>

<p>このスクリプトは、原文テキストを表示するほかに、単語などの文字列を入力するためのボックスを提供します。その文字列を含む OmegaT 分節が開かれたときに、スクリプトが警告を発します。警告は、黄色で強調されたスクリプトウィンドウ中のテキストとして表示されます。さらに、ハードウェアと OS が対応していれば（そうでないこともあります）、ビープ音が鳴ります。</p>

<p>この機能の使用例を以下に示します。原文テキストに含まれている「abc」という語句を、最初は「abc」と訳したとします。その後、「abc」ではなく「def」と訳すべきであることがわかりました。先に進む前に、すべての「abc」を検索して修正することも可能ですが、その方策には欠点もあります。そこで、次の訳文見直しの際に修正することにしました。この場合、該当する分節で「注意が喚起される」と便利でしょう。</p>

<p><strong>te-notags</strong></p>

<p>その名が示すように、このスクリプトは、OmegaT の分節の訳文からタグを自動削除します。これは、タグの多い分節を画面上で<i>チェックする</i>際に有用です。タグが多いと、スペースの抜けや重複を見逃しやすいからです。</p>

<p><strong>te-tags</strong></p>

<p>このスクリプトは、分節の訳文を、デフォルトの字体以外の特定の字体で表示します（スクリプトでハードコードされますが、編集可能です）。タグは、あまり目障りにならないように別の字体で表示されます。te-notags の場合とは異なり、表示ウィンドウ内で編集し、全体をコピーして OmegaT 編集ウィンドウに貼り付けることができます。</p>

<p><strong>te-gloss-highlight</strong></p>

<p>このスクリプトは、用語集ファイルの内容を読み込み、開いている分節の原文テキスト中に見つかった用語を強調します。用語集ファイルは、2 つの欄のみからなり、GLOSS.utf8 という名称で、script フォルダ内に置かれている必要があります。</p>

<p><strong>te-gloss-subst</strong></p>

<p>te-gloss-highlight と同様に機能しますが、用語集の原文用語を訳文用語に置き換えます。</p>

<p><strong>te-gloss-subst-highlight</strong></p>

<p>te-gloss-highlight の強調機能と te-gloss-subst の置換機能を組み合わせたものです。</p>

<h3>tcl/tk のプログラミング</h3>

<p>Tcl/tk は、スクリプト言語として数々の利点があります。</p>

<p>- 習得するのが簡単です。<br/>- 無料です。<br/>- 広く使われているので、インターネットで助言が見つかります<br/>- Tk ツールによって、グラフィカルユーザーインターフェースを生成するのが簡単です。<br/>- 多くの良書や関連リソースがあります（少なくとも英語では）。<br/>- ストリング指向であり、テキストを扱う用途に特に適しています。</p>

<p>初心者向けに、下記のような手引き書サイトがあります。</p>

<p><a href="http://www.dci.clrc.ac.uk/Publications/Cookbook/index.html">www.dci.clrc.ac.uk/Publications/Cookbook/index.html</a><br/><a href="http://www.tcl.tk/man/tcl8.5/tutorial/tcltutorial.html">www.tcl.tk/man/tcl8.5/tutorial/tcltutorial.html</a><br/><a href="http://www.tcl.tk/man/tcl8.5/tutorial/tcltutorial.html">www.tcl.tk/man/tcl8.5/tutorial/tcltutorial.html</a></p>

<p>tcl/tk を本気で習得したい方には、Brent Welch著『Practical Programming in Tcl and Tk』（ISBN: 0-13-038560-3）が特にお勧めです。この本は、プログラミングの初心者にはやや高度かもしれませんが、いずれかのオンライン手引き書を通読したあとであれば、きっと有用でしょう。</p>

<p>Copyright Marc Prior 2009-2011</p>

</div>

